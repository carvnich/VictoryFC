@model VictoryFC.Models.MatchesViewModel

@{
    ViewData["Title"] = "Matches";
}

<div class="card border shadow">
    <div class="card-body">
        <div class="row align-items-center mb-3">
            <div class="col">
                <h3 class="card-title d-none d-md-block mb-0"><i class="bi bi-calendar-event me-2"></i>All Matches</h3>
            </div>
            <div class="col-auto">
                <select class="form-select" id="competition-select">
                    <option value="all" selected>All Competitions</option>
                    <option value="regular">Division 3</option>
                    <option value="spence">Spence Cup</option>
                </select>
            </div>
        </div>

        <ul class="nav nav-pills mb-4" role="tablist">
            <li class="nav-item"><button class="nav-link text-black active" data-bs-toggle="pill" data-bs-target="#all-matches"><i class="bi bi-list-ul me-1"></i>All Matches</button></li>
            <li class="nav-item"><button class="nav-link text-black" data-bs-toggle="pill" data-bs-target="#victory-matches"><i class="bi bi-trophy me-1"></i>Victory FC</button></li>
        </ul>

        <div class="tab-content">
            <div class="tab-pane fade show active" id="all-matches">
                @{
                    var allMatches = Model.Matches.OrderByDescending(m => m.GameDate).GroupBy(m => m.GameDate.Date).OrderByDescending(g => g.Key);
                }
                @foreach (var dateGroup in allMatches)
                {
                    <div class="mb-4">
                        <h5 class="text-black mb-3 border-bottom pb-2">@dateGroup.Key.ToString("dddd, MMMM dd, yyyy")</h5>
                        @foreach (var match in dateGroup.OrderBy(m => m.GameDate))
                        {
                            @Html.Partial("_MatchRow", match)
                        }
                    </div>
                }
            </div>

            <div class="tab-pane fade" id="victory-matches">
                @{
                    var victoryMatches = Model.Matches.Where(m => m.HomeTeam == "Victory FC" || m.AwayTeam == "Victory FC").OrderByDescending(m => m.GameDate).GroupBy(m => m.GameDate.Date).OrderByDescending(g => g.Key);
                }
                @foreach (var dateGroup in victoryMatches)
                {
                    <div class="mb-4">
                        <h5 class="text-muted mb-3 border-bottom pb-2">@dateGroup.Key.ToString("dddd, MMMM dd, yyyy")</h5>
                        @foreach (var match in dateGroup.OrderBy(m => m.GameDate))
                        {
                            @Html.Partial("_MatchRow", match)
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>